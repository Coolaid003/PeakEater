{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Init Git Submodules",
      "type": "shell",
      "command": "rm -rf ${workspaceFolder}/Dependencies/ && git submodule update --init --recursive && cd ${workspaceFolder}/Dependencies/JUCE && git checkout ${config:peakeater.juce_version}"
    },
    {
      "label": "Clean Build Dir",
      "type": "shell",
      "command": "rm -rf ${workspaceFolder}/build/",
      "windows": {
        "command": "rmdir ${workspaceFolder}\build /s"
      }
    },
    {
      "label": "Build",
      "type": "shell",
      "problemMatcher": [
        "$gcc"
      ],
      "command": "cmake . -B build -DCMAKE_EXPORT_COMPILE_COMMANDS=TRUE -DJUCE_BUILD_EXAMPLES=OFF -DJUCE_BUILD_EXTRAS=ON -DCMAKE_BUILD_TYPE=${config:peakeater.config} && cmake --build build --config ${config:peakeater.config} --target ${config:peakeater.target} -j${config:peakeater.cpucores}",
      "windows": {
        "command": "cmake . -B build -G 'Visual Studio 16 2019' -T 'v140' -DCMAKE_EXPORT_COMPILE_COMMANDS=TRUE -DJUCE_BUILD_EXAMPLES=OFF -DJUCE_BUILD_EXTRAS=ON && cmake --build build --config ${config:peakeater.config} --target ${config:peakeater.target} -j${config:peakeater.cpucores}"
      }
    },
    {
      "label": "Build(Clean)",
      "type": "shell",
      "dependsOn": [
        "Init Git Submodules",
        "Util: Clean Build Dir",
        "Build"
      ],
      "dependsOrder": "sequence"
    },
    {
      "label": "Create release package",
      "type": "shell",
      "command": "python3 ${workspaceFolder}/Scripts/Release/MacOS.py --release_type=${config:peakeater.config}",
      "windows": {
        "command": "python3 ${workspaceFolder}/Scripts/Release/Windows.py --release_type=${config:peakeater.config}"
      }
    },
    {
      "label": "Run Standalone",
      "type": "shell",
      "command": "${workspaceFolder}/build/PeakEater_artefacts/${config:peakeater.config}/Standalone/PeakEater.app/Contents/MacOS/PeakEater"
    },
    {
      "label": "Clang Format",
      "type": "shell",
      "command": "find ${workspaceFolder}/Source/ -iname *.h -o -iname *.cpp | xargs clang-format --dry-run --Werror -i"
    }
  ]
}